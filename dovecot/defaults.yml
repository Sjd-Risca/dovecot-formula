dovecot:
  config:
    conf: '{}'
    ext:
      - ldap
      - sql
    auth_realms: '#this is a test'
    service:
      imap-login:
        inet_listener imap {:
          port: 143
        inet_listener imaps {:
          port: 993
          ssl: 'yes'
        service_count:
          state: '#'
          value: 1
          comment: |
              # Number of connections to handle before starting a new process. Typically
              # the only useful values are 0 (unlimited) or 1. 1 is more secure, but 0
              # is faster. <doc/wiki/LoginProcess.txt>
        process_min_avail:
          state: '#'
          value: 0
          comment: '# Number of processes to always keep waiting for more connections.'
        vsz_limit:
          state: '#'
          value: $default_vsz_limit
          comment: '# If you set service_count=0, you probably need to grow this.'
      pop3-login:
        inet_listener pop3 {:
          port: 110
        inet_listener pop3s {:
          port: 995
          ssl: 'yes'
      lmtp:
        unix_listener lmtp {:
          mode: 0666
        inet_listener lmtp {:
          state: '#'
          comment: "# Create inet listener only if you can't use the above UNIX socket"
          address: ''
          port: ''
      imap:
        vsz_limit:
          state: '#'
          value: $default_vsz_limit
          comment: |
              # Most of the memory goes to mmap()ing files. You may need to increase this
              # limit if you have huge mailboxes.
        process_limit:
          state: '#'
          value: 1024
          comment: '# Max. number of IMAP processes (connections)'
      pop3:
        process_limit:
          state: '#'
          value: 1024
          comment: '# Max. number of IMAP processes (connections)'
      auth:
        intro: |
            # auth_socket_path points to this userdb socket by default. It's typically
            # used by dovecot-lda, doveadm, possibly imap process, etc. Users that have
            # full permissions to this socket are able to get a list of all usernames and
            # get the results of everyone's userdb lookups.
            #
            # The default 0666 mode allows anyone to connect to the socket, but the
            # userdb lookups will succeed only if the userdb returns an "uid" field that
            # matches the caller process's UID. Also if caller's uid or gid matches the
            # socket's uid or gid the lookup succeeds. Anything else causes a failure.
            #
            # To give the caller full permissions to lookup all users, set the mode to
            # something else than 0666 and Dovecot lets the kernel enforce the
            # permissions (e.g. 0777 allows everyone full permissions).
        unix_listener auth-userdb {:
          mode: 0666
          user: ''
          group: ''
        user:
          comment: '# Auth process is run as this user.'
          state: '#'
          value: $default_internal_user
