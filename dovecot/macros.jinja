{% set cfg = pillar.get('dovecot:config', {}) -%}
{%- macro get_config(configname, default_value, state='#') -%}
    {%- if configname in cfg -%}
{{ configname }} = {{ cfg[configname] }}
    {%- else -%}
{{ state }}{{ configname }} = {{ default_value }}
    {%- endif -%}
{%- endmacro -%}

{%- macro to_include(auth_service) -%}
    {%- if cfg[auth_service] is defined -%}
!include {{ auth_service }}.conf.ext
    {%- else -%}
#!include {{ auth_service }}.conf.ext
    {%- endif -%}
{%- endmacro -%}

{%- macro namespace(name) -%}
namespace {{ name }} {
{%- for key, value in cfg.name.iteritems() -%}
    {%- if value is iterable -%}
  {{ key }} {
        {%- for subkey, subvalue in value -%}
    {{ subkey }} = {{ subvalue }}
        {%- endfor -%}
  }
   {%- else -%}
  {{ key }} = {{ value }}
{%- endfor -%}
}
{%- endmacro -%}
